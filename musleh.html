<!DOCTYPE html>
<html lang="en">
<head>
	<title>MUSLEH three.js</title>
	<meta charset="utf-8">
	<style>
		body {
			font-family: monospace;
			background-color: #000000;
			margin: 0px;
			overflow: hidden;
		}
	</style>
</head>
<body>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
	<script src="//rawgit.com/mrdoob/stats.js/master/build/stats.min.js"></script>
	<script src="js/three.min.js"></script>
	<script src="http://threejs.org/examples/js/controls/TrackballControls.js"></script>
	<script src="http://threejs.org/examples/js/controls/FlyControls.js"></script>
	<script>
		var container, stats;

		var camera, controls, scene, renderer, clock;

		var movingLight;

		var group;

		var targetRotation = 0;
		var targetRotationOnMouseDown = 0;

		var mouseX = 0;
		var mouseXOnMouseDown =0;

		var windowHalfX = window.innerWidth / 2;
		var windowHalfY = window.innerHeight/ 2;

		var floor_Mesh;
		var M_mesh, U_Mesh;

		var satellite_mesh;

		init();
		animate();

		function init () {

			container = document.createElement('div');
			document.body.appendChild(container);

			var info = document.createElement('div');
			info.style.position = 'absolute';
			info.style.top = '10px';
			info.style.width = '100%';
			info.style.color = '#ffffff';
			info.style.textAlign = 'center';
			info.innerHTML = 'This is my attempt at three.js';
			container.appendChild(info);

			scene = new THREE.Scene();

			clock = new THREE.Clock();

			camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 1, 1000);
			camera.position.set(-150,0,500);
			scene.add(camera);

			var light = new THREE.PointLight(0xffffff,0.8);
			camera.add(light);


			// controls = new THREE.FlyControls (camera);

			// controls.noZoom = false;
			// controls.noPan = false;
			// controls.staticMoving = true;

			// controls.movementSpeed = 1000;
			// controls.domElement = container;
			// controls.rollSpeed = Math.PI/24;
			// controls.autoForward = false;
			// controls.ragToLook = false;


			//controls.addEventListener ('change', render);


			group = new THREE.Group();
			group.position.y = 50;
			scene.add(group);
			group.position.set(-150,0,0);

			movingLight = new THREE.PointLight(0xffffff,3,1000);
			group.add(movingLight);

			renderer = new THREE.WebGLRenderer( {antialias: true});
			renderer.setClearColor(0x000000);
			renderer.setPixelRatio(window.devicePixelRatio);
			renderer.setSize(window.innerWidth, window.innerHeight);
			container.appendChild(renderer.domElement);

			stats = new Stats ();
			stats.domElement.style.position = 'absolute';
			stats.domElement.style.top = '0px';
			container.appendChild(stats.domElement);
			// stats.setMode(2);

			var extrudeSettings = { amount: 16, bevelEnabled: false, steps: 2 };

			var M_Pts = [];
			M_Pts.push( new THREE.Vector2 (0,25));
			M_Pts.push( new THREE.Vector2 (20,25));
			M_Pts.push( new THREE.Vector2 (25,20));
			M_Pts.push( new THREE.Vector2 (30,25));
			M_Pts.push( new THREE.Vector2 (50,25));
			M_Pts.push( new THREE.Vector2 (50,0 ));
			M_Pts.push( new THREE.Vector2 (30,0 ));
			M_Pts.push( new THREE.Vector2 (30,15));
			M_Pts.push( new THREE.Vector2 (25,10));
			M_Pts.push( new THREE.Vector2 (20,15));
			M_Pts.push( new THREE.Vector2 (20,0 ));
			M_Pts.push( new THREE.Vector2 (0,0 ));
			M_Pts.push( new THREE.Vector2 (0,25));

			var M = new THREE.Shape ( M_Pts );

			var M_geometry = new THREE.ExtrudeGeometry( M , extrudeSettings);

			M_mesh = new THREE.Mesh (M_geometry, new THREE.MeshPhongMaterial( { color: 0x000000 }));

			M_mesh.position.set(0,0,0);
			M_mesh.rotation.set(0,0,0);
			M_mesh.scale.set(1,1,1);
			group.add(M_mesh);

			var U_Pts = [];
			U_Pts.push(new THREE.Vector2(0,25));
			U_Pts.push(new THREE.Vector2(20,25));
			U_Pts.push(new THREE.Vector2(20,10));
			U_Pts.push(new THREE.Vector2(30,10));
			U_Pts.push(new THREE.Vector2(30,25));
			U_Pts.push(new THREE.Vector2(50,25));
			U_Pts.push(new THREE.Vector2(50,0));
			U_Pts.push(new THREE.Vector2(0,0));
			U_Pts.push(new THREE.Vector2(0,25));

			var U = new THREE.Shape( U_Pts);

			var U_geometry = new THREE.ExtrudeGeometry( U, extrudeSettings);

			U_Mesh = new THREE.Mesh(U_geometry, new THREE.MeshPhongMaterial( { color: 0x000000 }));

			U_Mesh.position.set(60,0,0);
			U_Mesh.rotation.set(0,0,0);
			U_Mesh.scale.set(1,1,1);
			group.add(U_Mesh);

			var S_Pts = [];
			S_Pts.push(new THREE.Vector2(0,25));
			S_Pts.push(new THREE.Vector2(50,25));
			S_Pts.push(new THREE.Vector2(50,20));
			S_Pts.push(new THREE.Vector2(20,20));
			S_Pts.push(new THREE.Vector2(20,15));
			S_Pts.push(new THREE.Vector2(50,15));
			S_Pts.push(new THREE.Vector2(50,0));
			S_Pts.push(new THREE.Vector2(0,0));
			S_Pts.push(new THREE.Vector2(0,5));
			S_Pts.push(new THREE.Vector2(30,5));
			S_Pts.push(new THREE.Vector2(30,10));
			S_Pts.push(new THREE.Vector2(0,10));
			S_Pts.push(new THREE.Vector2(0,25));

			var S = new THREE.Shape(S_Pts);

			var S_geometry = new THREE.ExtrudeGeometry(S,extrudeSettings);

			S_Mesh = new THREE.Mesh(S_geometry, new THREE.MeshPhongMaterial({color: 0x000000}));

			S_Mesh.position.set(120,0,0);
			S_Mesh.rotation.set(0,0,0);
			S_Mesh.scale.set(1,1,1);
			group.add(S_Mesh);
			
			var floor_geometry = new THREE.BoxGeometry(110,2,16);
			var floor_material = new THREE.MeshPhongMaterial({color : 0x0000ff});
			floor_Mesh = new THREE.Mesh(floor_geometry,floor_material);
			// floor_Mesh.material.side = THREE.DoubleSide;
			floor_Mesh.position.set(55,-1,-8);
			group.add(floor_Mesh);
			//add the satellite
			var satellite = new THREE.SphereGeometry (10,16,8);

			satellite_mesh = new THREE.Mesh(satellite, new THREE.MeshPhongMaterial({color: 0xf0f0ff}));
			group.add(satellite_mesh);
			//scene.add(satellite_mesh);
			satellite_mesh.position.set(55,13,0);
			satellite_mesh.rotation.set(0,0,0);
			satellite_mesh.scale.set(1,1,1);

			// var material = new THREE.LineBasicMaterial({color:0xffffff, opacity:1});
			// var ellipse = new THREE.EllipseCurve(0, 0, 105, 0, 0, 2.0 * Math.PI, false);
			// var ellipsePath = new THREE.CurvePath();
			// ellipsePath.add(ellipse);
			// var ellipseGeometry = ellipsePath.createPointsGeometry(1000);
			// ellipseGeometry.computeTangents();
			// var line = new THREE.Line(ellipseGeometry, material);
			// group.add( line );
		}

		function animate (){

			requestAnimationFrame (animate);
			
			render();
			stats.update();
			//controls.update();

		}

		// var group_length = 50 + 10 + 50;
		// var group_height = 25;
		// var ratio = (group_height+50)/(group_length + 100);
		// // alert(ratio);
		// var minus_X = 1;
		// var minus_Y = 1;
		// var idx = 0;
		// function update_X (current_X, z) {
		// 	if (current_X <= -50) {minus_X=1;};
		// 	if ((current_X > -50) && (current_X < (group_length+50))) {};
		// 	if (current_X >= (group_length+50)) {minus_X=-1;};
		// 	// if (idx<10) {alert((minus_X*(Math.abs(z)/(Math.abs(current_X)))));idx+=1;};
		// 	return (current_X += (minus_X*(Math.abs(z)/(Math.abs(current_X)))));
		// }

		// function update_Y (current_Y) {
		// 	if (current_Y <= -25) {minus_Y=1};
		// 	if (current_Y > -25 && current_Y < (group_height+25)) {};
		// 	if (current_Y >= (group_height+25)) {minus_Y=-1};
		// 	return current_Y += (minus_Y);
		// }

		var x=0;

		function render() {

			var rotaionSpeed = 1.0;
			//group.rotation.y += (targetRotation - group.rotation.y ) * 0.05;
			var delta = clock.getDelta();
			// M_mesh.rotation.y += rotaionSpeed * delta;
			//group.rotation.y += rotaionSpeed * delta;
			// controls.update(delta);
			var time = Date.now() * 0.001;
			// var yo = [1,1,1,1,1,1];
			// if ( x < 10 ) {alert(satellite_mesh.position.y/75);x+=1;};
			

			satellite_mesh.position.x = 150 * Math.cos (time);
			satellite_mesh.position.y = 75 * Math.sin (time * 1.25);
			satellite_mesh.position.z = 100 * Math.sin (time);
			movingLight.position.copy (satellite_mesh.position);
			//satellite_mesh.position.x = update_X(satellite_mesh.position.x, Math.sin(time));
			//satellite_mesh.position.y = update_Y(satellite_mesh.position.y);
			camera.lookAt(scene.position);

			renderer.clear();
			renderer.render(scene,camera);

		}

	</script>
</body>
</html>